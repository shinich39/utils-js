"use strict";function t(t){return"boolean"==typeof t}function e(t){return"number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)}function r(t){return"string"==typeof t}function n(t){return"object"==typeof t&&null!==t}function o(t){return"object"==typeof t&&null===t}function i(t){return Array&&Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function u(t){return"function"==typeof t}function c(t){return void 0===t}function l(t){let e;e=i(t)?[]:{};for(const[r,o]of Object.entries(t))n(o)?e[r]=l(o):e[r]=o;return e}function s(t,e){return Math.random()*(e-t)+t}function f(l,s){const f=[c,o,t,e,r,n,i,u],a=f.findIndex((function(t){return t(l)})),p=f.findIndex((function(t){return t(s)}));return a!==p?a-p:0===a||1===a?0:2===a?l!==s?0:l?1:-1:3===a?l-s:4===a?l.localeCompare(s,void 0,{numeric:!0}):5===a?Object.keys(l).length-Object.keys(s).length:6===a?l.length-s.length:0}function a(t,e){if(1===t.length)return t[0];let r=[];for(let n=0;n<t.length-1;n++){let o=(1-e)*t[n][0]+e*t[n+1][0],i=(1-e)*t[n][1]+e*t[n+1][1];r.push([o,i])}return a(r,e)}let p=0;const h=[["&","&amp;"],[" ","&nbsp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"],["¢","&cent;"],["£","&pound;"],["¥","&yen;"],["€","&euro;"],["©","&copy;"],["®","&reg;"]],g=[["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];function x(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r],r,t))return r;return-1}function d(t){return encodeURIComponent(t)}function m(t){return decodeURIComponent(t)}function y(t){for(let e=h.length-1;e>=0;e--)t=t.replace(new RegExp(h[e][1],"g"),h[e][0]);return t}function A(t){for(let e=0;e<g.length;e++)t=t.replace(new RegExp(g[e][0],"g"),g[e][1]);return t}function $(t){return t.replace(/(>)([\s\S]*?)(<)/g,(function(...t){return`${t[1]}${function(t){for(let e=0;e<h.length;e++)t=t.replace(new RegExp(h[e][0],"g"),h[e][1]);return t}(t[2])}${t[3]}`}))}function b(t){let e=function(t){return t.replace(/^\</,"").replace(/([^\<][!?/])?\>$/,"").replace(/\s+/g," ").trim()}(t).split(/\s/),r={};r.tag=e[0]||"",r.closer=null,r.content=null,r.attributes={},r.children=[],r.isClosing=/^\//.test(r.tag),r.isClosed=r.isClosing,r.tag=r.tag.replace(/^\//,"");for(let t=1;t<e.length;t++){let[n,o]=e[t].split("=");n.length>0&&(r.attributes[n]="string"!=typeof o||m(o))}return r}exports.compareObject=f,exports.compareString=function(t,e){return function(t,e,r){let n=[],o=0,i=e.length,u=r.length;for(;i>0||u>0;){const c=n[n.length-1],l=e[i-1],s=r[u-1];i>0&&u>0&&l===s?(c&&0===c.type?c.value=l+c.value:n.push({type:0,value:l}),o++,i--,u--):u>0&&(0===i||t[i][u-1]>=t[i-1][u])?(c&&1===c.type?c.value=s+c.value:n.push({type:1,value:s}),u--):i>0&&(0===u||t[i][u-1]<t[i-1][u])&&(c&&-1===c.type?c.value=l+c.value:n.push({type:-1,value:l}),i--)}return{acc:2*o/(e.length+r.length),result:n.reverse()}}(function(t,e,r){for(let n=1;n<=e.length;n++)for(let o=1;o<=r.length;o++)e[n-1]===r[o-1]?t[n][o]=t[n-1][o-1]+1:t[n][o]=Math.max(t[n-1][o],t[n][o-1]);return t}(function(t,e){const r=[];for(let n=0;n<t.length+1;n++){r.push([]);for(let t=0;t<e.length+1;t++)r[n][t]=0}return r}(t,e),t,e),t,e)},exports.copyObject=l,exports.createArray=function(t,e){let r=new Array(t);if(u(e))for(let n=0;n<t;n++)r[n]=e(n);else if(n(e))for(let n=0;n<t;n++)r[n]=l(e);else if(i(e))for(let n=0;n<t;n++)r[n]=l(e);else if(void 0!==e)for(let n=0;n<t;n++)r[n]=e;return r},exports.domToStr=function t(e){const{tag:r,closer:n,attributes:o,content:i,children:u}=e;let c="";if("string"==typeof r){if(c+=`<${r}`,"object"==typeof o&&(c+=function(t){let e="";for(const[r,n]of Object.entries(t))"string"==typeof n?e+=` ${r}="${A(n)}"`:!0===n&&(e+=` ${r}`);return e}(o)),"string"!=typeof n&&(c+=">"),Array.isArray(u))for(const e of u)c+=t(e);c+="string"==typeof n?`${n}>`:`</${r}>`}else if("string"==typeof i)c=i;else if(Array.isArray(u))for(const e of u)c+=t(e);return c},exports.encryptString=function(t,e){if(0===e.length)return t;let r="",n=0;for(;e.length<t.length;)e+=e;for(;n<t.length;)r+=String.fromCharCode(t.charCodeAt(n)^e.charCodeAt(n)),n++;return r},exports.fromBase64=function(t){let e=(t=String(t).replace(/^data:([A-Za-z-+\/]+);[A-Za-z0-9]+,/,"").replace(/[\t\n\f\r ]/g,"")).length;if(e%4==0&&(e=(t=t.replace(/==?$/,"")).length),e%4==1||/[^+a-zA-Z0-9/]/.test(t))throw new Error("Invalid character: the string to be decoded is not correctly encoded.");let r,n,o=0,i="",u=-1;for(;++u<e;)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(u)),r=o%4?64*r+n:n,o++%4&&(i+=String.fromCharCode(255&r>>(-2*o&6)));return i},exports.generateObjectId=function(t,e){return t=t?new Date(t).getTime()/1e3:(new Date).getTime()/1e3,e?p=e:e=p++,Math.floor(t).toString(16)+"xxxxxxxxxx".replace(/x/g,(function(t){return Math.floor(16*Math.random()).toString(16)}))+Math.floor(e).toString(16).padStart(6,"0")},exports.generateRandomNumber=s,exports.generateRandomString=function(t){return t.charAt(Math.floor(Math.random()*t.length))},exports.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){let e,r=16*Math.random()|0;return e="x"==t?r:3&r|8,e.toString(16)}))},exports.getBezierPoint=a,exports.getClampedNumber=function(t,e,r){return Math.min(r,Math.max(t,e))},exports.getContainedNumber=function(t,e,r){return r-=e,(t-=e)<0&&(t=t%r+r),t>=r&&(t%=r),t+e},exports.getContainedSize=function(t,e){const r=t.width/t.height;return r<e.width/e.height?{width:e.height*r,height:e.height}:{width:e.width,height:e.width/r}},exports.getCoveredSize=function(t,e){const r=t.width/t.height;return r<e.width/e.height?{width:e.width,height:e.width/r}:{width:e.height*r,height:e.height}},exports.getMaxValue=function(t){return t.reduce((function(t,e){return e>t?e:t}),t[0]||0)},exports.getMeanValue=function(t){return t.reduce((function(t,e){return t+e}),0)/t.length},exports.getMinValue=function(t){return t.reduce((function(t,e){return e<t?e:t}),t[0]||0)},exports.getModeValue=function(t){let e={},r=t[0],n=1;for(let o=0;o<t.length;o++){const i=t[o];e[i]?e[i]+=1:e[i]=1,e[i]>n&&(r=i,n=e[i])}return r},exports.getRandomValue=function(t){return t[Math.floor(s(0,t.length))]},exports.getRelativePath=function(t,e){t=(t+"/").replace(/[\\\/]+/g,"/").replace(/^\.?\//,""),e=(e+"/").replace(/[\\\/]+/g,"/").replace(/^\.?\//,"");let r="";for(;!e.startsWith(t);)r+="../",t=t.substring(0,t.lastIndexOf("/",t.length-2)+1);return r+=e.substring(t.length,e.length),r.replace(/[\\\/]$/,"")},exports.groupByKey=function(t,e){let r={};for(const n of t){const t=String(n[e]);r[t]?r[t].push(n):r[t]=[n]}return r},exports.isArray=i,exports.isBoolean=t,exports.isBooleanArray=function(e){if(!i(e))return!1;for(const r of e)if(!t(r))return!1;return!0},exports.isEmpty=function(t){return void 0===t||o(t)},exports.isEmptyArray=function(t){return i(t)&&0===t.length},exports.isEmptyObject=function(t){return n(t)&&0===Object.keys(t).length},exports.isEmptyString=function(t){return r(t)&&""===t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},exports.isFunction=u,exports.isNull=o,exports.isNumber=e,exports.isNumberArray=function(t){if(!i(t))return!1;for(const r of t)if(!e(r))return!1;return!0},exports.isNumeric=function(t){return r(t)?!Number.isNaN(parseFloat(t))&&Number.isFinite(parseFloat(t)):e(t)},exports.isObject=n,exports.isObjectArray=function(t){if(!i(t))return!1;for(const e of t)if(!n(e))return!1;return!0},exports.isSameType=function(t,e){return o(t)&&o(e)||typeof t==typeof e&&t.constructor===e.constructor},exports.isString=r,exports.isStringArray=function(t){if(!i(t))return!1;for(const e of t)if(!r(e))return!1;return!0},exports.isUndefined=c,exports.parseCommand=function(t){let e=[],r=0,n=t.replace(/\\'|\\"/g,"00"),o=null,i="";for(;r<t.length;)o?n[r]===o?(e.push(i),i="",o=null):i+=t[r]:"'"===n[r]||'"'===n[r]?o=t[r]:" "===n[r]?""!==i&&(e.push(i),i=""):i+=t[r],r++;return""!==i.trim()&&e.push(i),e},exports.parsePath=function(t){let e=(t=t.replace(/[\\\/]+/g,"/").replace(/\/$/,"").replace(/^\.?\//,"")).split("/"),r="",n="",o=".",i="";return e.length>0&&(n=e.pop(),/\.[^\\\/.]+?$/.test(n)&&(i="."+n.split(".").pop()),r=n.replace(new RegExp(i+"$"),"")),e.length>0&&(o=e.join("/")),{dirs:e,filename:r,basename:n,dirname:o,extname:i}},exports.parseQueryString=function(t){let e=t.split("?").pop().split("&"),r={};for(const t of e){const e=t.split("=").map(decodeURIComponent);r[e[0]]?r[e[0]].push(decodeURIComponent(e[1])):r[e[0]]=[decodeURIComponent(e[1])]}return r},exports.parseTemplate=function(t,e){return t.replace(/\$\{[^}]*?\}/g,(function(t){let r=e,o=t.substring(2,t.length-1).split(/\.|\[['"]?|['"]?\]/).filter(Boolean),u=o.pop();for(;n(r)&&o.length>0;)r=r[o.shift()];return n(r)||i(r)?r[u]:""}))},exports.promiseAll=function(t){return t.reduce((function(t,e){return t.then((function(t){return e().then((function(e){return t.concat([e])}))}))}),Promise.resolve([]))},exports.queryObject=function(t,e){function r(t,e){for(const[r,n]of Object.entries(e))if(!o(t,n,r.split(".")))return!1;return!0}function o(t,e,r){const i=r.shift();return r.length>0?!!n(t)&&o(t[i],e,r):u(t,e,i)}function u(t,e,o){if("$and"===o){for(const n of e)if(!r(t,n))return!1;return!0}if("$nand"===o)return!u(t,e,"$and");if("$or"===o){for(const n of e)if(r(t,n))return!0;return!1}if("$nor"===o)return!u(t,e,"$or");if("$not"===o)return!r(t,e);if("$in"===o){if(i(t)){for(const r of t)if(!u(r,e,"$in"))return!1;return!0}for(const r of e)if(u(t,r,"$eq"))return!0;return!1}if("$nin"===o)return!u(t,e,"$in");if("$gt"===o)return t>e;if("$gte"===o)return t>=e;if("$lt"===o)return t<e;if("$lte"===o)return t<=e;if("$eq"===o){if(i(t)&&i(e)){if(t.length!==e.length)return!1;for(let r=0;r<e.length;r++)if(!u(t[r],e[r],"$eq"))return!1;return!0}return t===e}return"$ne"===o?!u(t,e,"$eq"):"$exists"===o?null!=t===Boolean(e):"$fn"===o?e(t):"$re"===o?e.test(t):!!n(t)&&(n(e)?r(t[o],e):u(t[o],e,"$eq"))}return r(t,e)},exports.setAnimation=function(t,e,r,n){r||(r=1e3),n||(n=100);let o=0,i=a(t,o/r);e(i,o,function u(){return o+=n,i=a(t,o/r),setTimeout((function(){e(i,o,o<r?u():null)}),n)}())},exports.shuffleArray=function(t){let e=t.length;for(;e>0;){let r=Math.floor(Math.random()*e);e--,[t[e],t[r]]=[t[r],t[e]]}return t},exports.sortArray=function(t,e){return e=Boolean(e),t.sort((function(t,r){return e?!f(t,r):f(t,r)}))},exports.sortBy=function(t,e){return"string"==typeof e&&(e=e.split(" ").filter(Boolean)),t.sort((function(t,r){for(const n of e){const e=/^-/.test(n),o=n.replace(/^-/,""),i=f(t[o],r[o]);if(0!==i)return e?-i:i}return 0}))},exports.splitFloat=function(t){return t.split(/([0-9]+\.[0-9]+)+/)},exports.splitInt=function(t){return t.split(/([0-9]+)/)},exports.spreadArray=function(t){function e(t,e){for(let r=t.length-1;r>=0;r--){if(e[r]<t[r].length-1)return e[r]+=1,e;e[r]=0}}function r(t,e){let r=[];for(let n=0;n<t.length;n++)r.push(t[n][e[n]]);return r}return function(){let n=[],o=function(t){if(t.length<1)return;let e=[];for(let r=0;r<t.length;r++)e.push(0);return e}(t);for(;o;)n.push(r(t,o)),o=e(t,o);return n}()},exports.strToDom=function(t){t=function(t){function e(...t){return`=${d(t[1])} `}return t.replace(/\='([^'>]*?)'/g,e).replace(/\="([^">]*?)"/g,e)}($(function(t){return t.replace(/(<script(?:[\s\S]*?)>)([\s\S]*?)(<\/script>)/g,(function(...t){return`${t[1]}${d(t[2])}${t[3]}`}))}(function(t){return t.replace(/<!--([\s\S]*?)-->/g,(function(...t){return`\x3c!--\x3e${d(t[1])}</!--\x3e`}))}(function(t){return t.replace(/\r\n/g,"\n")}(t)))));let e,r,n=0,o=/<[^>]*?>/g,i=[],u=[];for(;e=o.exec(t);){let c=t.substring(n,e.index).trim();if(c.length>0&&(r={tag:null,closer:null,content:y(c),attributes:{},children:[]},i.push(r)),r=b(e[0]),r.isClosing){let t=x(i,(function(t){return!t.isClosed&&t.tag===r.tag}));if(t>-1&&(i[t].isClosed=!0,i[t].children=i.splice(t+1,i.length-t+1),["script","!--"].indexOf(i[t].tag)>-1))for(let e=0;e<i[t].children.length;e++)null===i[t].children[e].tag&&(i[t].children[e].content=m(i[t].children[e].content))}else i.push(r),u.push(r);n=o.lastIndex}for(let t of u)"!DOCTYPE"===t.tag.toUpperCase()?t.closer="":"?xml"===t.tag.toLowerCase()?t.closer="?":"!--"===t.tag?t.closer="--":t.isClosed||(t.closer=" /"),delete t.isClosed,delete t.isClosing;return{tag:null,closer:null,content:null,attributes:{},children:i}},exports.toBase64=function(t,e){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(t=String(t),/[^\0-\xFF]/.test(t))throw new Error("The string to be encoded contains characters outside of the Latin1 range.");let n,o,i,u,c=t.length%3,l="",s=-1,f=t.length-c;for(;++s<f;)n=t.charCodeAt(s)<<16,o=t.charCodeAt(++s)<<8,i=t.charCodeAt(++s),u=n+o+i,l+=r.charAt(u>>18&63)+r.charAt(u>>12&63)+r.charAt(u>>6&63)+r.charAt(63&u);return 2==c?(n=t.charCodeAt(s)<<8,o=t.charCodeAt(++s),u=n+o,l+=r.charAt(u>>10)+r.charAt(u>>4&63)+r.charAt(u<<2&63)+"="):1==c&&(u=t.charCodeAt(s),l+=r.charAt(u>>2)+r.charAt(u<<4&63)+"=="),e?"data:"+e+";base64,"+l:l},exports.toFullWidth=function(t){return t.replace(/[!-~]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)+65248)})).replace(/[^\S\r\n]/g,"　")},exports.toHalfWidth=function(t){return t.replace(/[！-～]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)-65248)})).replace(/[^\S\r\n]/g," ")},exports.wait=function(t){return new Promise((function(e){return setTimeout(e,t)}))};
