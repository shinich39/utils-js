!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).utils={})}(this,(function(t){"use strict";function e(t){return"boolean"==typeof t}function n(t){return"number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)}function r(t){return"string"==typeof t}function o(t){return"object"==typeof t&&null!==t}function i(t){return"object"==typeof t&&null===t}function u(t){return Array&&Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function l(t){return"function"==typeof t}function f(t){return void 0===t}function c(t){let e;e=u(t)?[]:{};for(const[n,r]of Object.entries(t))o(r)?e[n]=c(r):e[n]=r;return e}function s(t,e){return Math.random()*(e-t)+t}function a(t,c){const s=[f,i,e,n,r,o,u,l],a=s.findIndex((function(e){return e(t)})),h=s.findIndex((function(t){return t(c)}));return a!==h?a-h:0===a||1===a?0:2===a?t!==c?0:t?1:-1:3===a?t-c:4===a?t.localeCompare(c,void 0,{numeric:!0}):5===a?Object.keys(t).length-Object.keys(c).length:6===a?t.length-c.length:0}function h(t,e){if(1===t.length)return t[0];let n=[];for(let r=0;r<t.length-1;r++){let o=(1-e)*t[r][0]+e*t[r+1][0],i=(1-e)*t[r][1]+e*t[r+1][1];n.push([o,i])}return h(n,e)}let g=0;const p=[["&","&amp;"],[" ","&nbsp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"],["¢","&cent;"],["£","&pound;"],["¥","&yen;"],["€","&euro;"],["©","&copy;"],["®","&reg;"]],d=[["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];function x(t,e){for(let n=t.length-1;n>=0;n--)if(e(t[n],n,t))return n;return-1}function y(t){return encodeURIComponent(t)}function m(t){return decodeURIComponent(t)}function b(t){for(let e=p.length-1;e>=0;e--)t=t.replace(new RegExp(p[e][1],"g"),p[e][0]);return t}function A(t){for(let e=0;e<d.length;e++)t=t.replace(new RegExp(d[e][0],"g"),d[e][1]);return t}function $(t){return t.replace(/(>)([\s\S]*?)(<)/g,(function(...t){return`${t[1]}${function(t){for(let e=0;e<p.length;e++)t=t.replace(new RegExp(p[e][0],"g"),p[e][1]);return t}(t[2])}${t[3]}`}))}function C(t){let e=function(t){return t.replace(/^\</,"").replace(/([^\<][!?/])?\>$/,"").replace(/\s+/g," ").trim()}(t).split(/\s/),n={};n.tag=e[0]||"",n.closer=null,n.content=null,n.attributes={},n.children=[],n.isClosing=/^\//.test(n.tag),n.isClosed=n.isClosing,n.tag=n.tag.replace(/^\//,"");for(let t=1;t<e.length;t++){let[r,o]=e[t].split("=");r.length>0&&(n.attributes[r]="string"!=typeof o||m(o))}return n}t.compareObject=a,t.compareString=function(t,e){return function(t,e,n){let r=[],o=0,i=e.length,u=n.length;for(;i>0||u>0;){const l=r[r.length-1],f=e[i-1],c=n[u-1];i>0&&u>0&&f===c?(l&&0===l.type?l.value=f+l.value:r.push({type:0,value:f}),o++,i--,u--):u>0&&(0===i||t[i][u-1]>=t[i-1][u])?(l&&1===l.type?l.value=c+l.value:r.push({type:1,value:c}),u--):i>0&&(0===u||t[i][u-1]<t[i-1][u])&&(l&&-1===l.type?l.value=f+l.value:r.push({type:-1,value:f}),i--)}return{acc:2*o/(e.length+n.length),result:r.reverse()}}(function(t,e,n){for(let r=1;r<=e.length;r++)for(let o=1;o<=n.length;o++)e[r-1]===n[o-1]?t[r][o]=t[r-1][o-1]+1:t[r][o]=Math.max(t[r-1][o],t[r][o-1]);return t}(function(t,e){const n=[];for(let r=0;r<t.length+1;r++){n.push([]);for(let t=0;t<e.length+1;t++)n[r][t]=0}return n}(t,e),t,e),t,e)},t.copyObject=c,t.createArray=function(t,e){let n=new Array(t);if(l(e))for(let r=0;r<t;r++)n[r]=e(r);else if(o(e))for(let r=0;r<t;r++)n[r]=c(e);else if(u(e))for(let r=0;r<t;r++)n[r]=c(e);else if(void 0!==e)for(let r=0;r<t;r++)n[r]=e;return n},t.domToStr=function t(e){const{tag:n,closer:r,attributes:o,content:i,children:u}=e;let l="";if("string"==typeof n){if(l+=`<${n}`,"object"==typeof o&&(l+=function(t){let e="";for(const[n,r]of Object.entries(t))"string"==typeof r?e+=` ${n}="${A(r)}"`:!0===r&&(e+=` ${n}`);return e}(o)),"string"!=typeof r&&(l+=">"),Array.isArray(u))for(const e of u)l+=t(e);l+="string"==typeof r?`${r}>`:`</${n}>`}else if("string"==typeof i)l=i;else if(Array.isArray(u))for(const e of u)l+=t(e);return l},t.encryptString=function(t,e){if(0===e.length)return t;let n="",r=0;for(;e.length<t.length;)e+=e;for(;r<t.length;)n+=String.fromCharCode(t.charCodeAt(r)^e.charCodeAt(r)),r++;return n},t.fromBase64=function(t){let e=(t=String(t).replace(/^data:([A-Za-z-+\/]+);[A-Za-z0-9]+,/,"").replace(/[\t\n\f\r ]/g,"")).length;if(e%4==0&&(e=(t=t.replace(/==?$/,"")).length),e%4==1||/[^+a-zA-Z0-9/]/.test(t))throw new Error("Invalid character: the string to be decoded is not correctly encoded.");let n,r,o=0,i="",u=-1;for(;++u<e;)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(u)),n=o%4?64*n+r:r,o++%4&&(i+=String.fromCharCode(255&n>>(-2*o&6)));return i},t.generateObjectId=function(t,e){return t=t?new Date(t).getTime()/1e3:(new Date).getTime()/1e3,e?g=e:e=g++,Math.floor(t).toString(16)+"xxxxxxxxxx".replace(/x/g,(function(t){return Math.floor(16*Math.random()).toString(16)}))+Math.floor(e).toString(16).padStart(6,"0")},t.generateRandomNumber=s,t.generateRandomString=function(t){return t.charAt(Math.floor(Math.random()*t.length))},t.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){let e,n=16*Math.random()|0;return e="x"==t?n:3&n|8,e.toString(16)}))},t.getBezierPoint=h,t.getClampedNumber=function(t,e,n){return Math.min(n,Math.max(t,e))},t.getContainedNumber=function(t,e,n){return n-=e,(t-=e)<0&&(t=t%n+n),t>=n&&(t%=n),t+e},t.getContainedSize=function(t,e){const n=t.width/t.height;return n<e.width/e.height?{width:e.height*n,height:e.height}:{width:e.width,height:e.width/n}},t.getCoveredSize=function(t,e){const n=t.width/t.height;return n<e.width/e.height?{width:e.width,height:e.width/n}:{width:e.height*n,height:e.height}},t.getMaxValue=function(t){return t.reduce((function(t,e){return e>t?e:t}),t[0]||0)},t.getMeanValue=function(t){return t.reduce((function(t,e){return t+e}),0)/t.length},t.getMinValue=function(t){return t.reduce((function(t,e){return e<t?e:t}),t[0]||0)},t.getModeValue=function(t){let e={},n=t[0],r=1;for(let o=0;o<t.length;o++){const i=t[o];e[i]?e[i]+=1:e[i]=1,e[i]>r&&(n=i,r=e[i])}return n},t.getRandomValue=function(t){return t[Math.floor(s(0,t.length))]},t.getRelativePath=function(t,e){t=(t+"/").replace(/[\\\/]+/g,"/").replace(/^\.?\//,""),e=(e+"/").replace(/[\\\/]+/g,"/").replace(/^\.?\//,"");let n="";for(;!e.startsWith(t);)n+="../",t=t.substring(0,t.lastIndexOf("/",t.length-2)+1);return n+=e.substring(t.length,e.length),n.replace(/[\\\/]$/,"")},t.groupByKey=function(t,e){let n={};for(const r of t){const t=String(r[e]);n[t]?n[t].push(r):n[t]=[r]}return n},t.isArray=u,t.isBoolean=e,t.isBooleanArray=function(t){if(!u(t))return!1;for(const n of t)if(!e(n))return!1;return!0},t.isEmpty=function(t){return void 0===t||i(t)},t.isEmptyArray=function(t){return u(t)&&0===t.length},t.isEmptyObject=function(t){return o(t)&&0===Object.keys(t).length},t.isEmptyString=function(t){return r(t)&&""===t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},t.isFunction=l,t.isNull=i,t.isNumber=n,t.isNumberArray=function(t){if(!u(t))return!1;for(const e of t)if(!n(e))return!1;return!0},t.isNumeric=function(t){return r(t)?!Number.isNaN(parseFloat(t))&&Number.isFinite(parseFloat(t)):n(t)},t.isObject=o,t.isObjectArray=function(t){if(!u(t))return!1;for(const e of t)if(!o(e))return!1;return!0},t.isSameType=function(t,e){return i(t)&&i(e)||typeof t==typeof e&&t.constructor===e.constructor},t.isString=r,t.isStringArray=function(t){if(!u(t))return!1;for(const e of t)if(!r(e))return!1;return!0},t.isUndefined=f,t.parseCommand=function(t){let e=[],n=0,r=t.replace(/\\'|\\"/g,"00"),o=null,i="";for(;n<t.length;)o?r[n]===o?(e.push(i),i="",o=null):i+=t[n]:"'"===r[n]||'"'===r[n]?o=t[n]:" "===r[n]?""!==i&&(e.push(i),i=""):i+=t[n],n++;return""!==i.trim()&&e.push(i),e},t.parsePath=function(t){let e=(t=t.replace(/[\\\/]+/g,"/").replace(/\/$/,"").replace(/^\.?\//,"")).split("/"),n="",r="",o=".",i="";return e.length>0&&(r=e.pop(),/\.[^\\\/.]+?$/.test(r)&&(i="."+r.split(".").pop()),n=r.replace(new RegExp(i+"$"),"")),e.length>0&&(o=e.join("/")),{dirs:e,filename:n,basename:r,dirname:o,extname:i}},t.parseQueryString=function(t){let e=t.split("?").pop().split("&"),n={};for(const t of e){const e=t.split("=").map(decodeURIComponent);n[e[0]]?n[e[0]].push(decodeURIComponent(e[1])):n[e[0]]=[decodeURIComponent(e[1])]}return n},t.parseTemplate=function(t,e){return t.replace(/\$\{[^}]*?\}/g,(function(t){let n=e,r=t.substring(2,t.length-1).split(/\.|\[['"]?|['"]?\]/).filter(Boolean),i=r.pop();for(;o(n)&&r.length>0;)n=n[r.shift()];return o(n)||u(n)?n[i]:""}))},t.promiseAll=function(t){return t.reduce((function(t,e){return t.then((function(t){return e().then((function(e){return t.concat([e])}))}))}),Promise.resolve([]))},t.queryObject=function(t,e){function n(t,e){for(const[n,o]of Object.entries(e))if(!r(t,o,n.split(".")))return!1;return!0}function r(t,e,n){const u=n.shift();return n.length>0?!!o(t)&&r(t[u],e,n):i(t,e,u)}function i(t,e,r){if("$and"===r){for(const r of e)if(!n(t,r))return!1;return!0}if("$nand"===r)return!i(t,e,"$and");if("$or"===r){for(const r of e)if(n(t,r))return!0;return!1}if("$nor"===r)return!i(t,e,"$or");if("$not"===r)return!n(t,e);if("$in"===r){if(u(t)){for(const n of t)if(!i(n,e,"$in"))return!1;return!0}for(const n of e)if(i(t,n,"$eq"))return!0;return!1}if("$nin"===r)return!i(t,e,"$in");if("$gt"===r)return t>e;if("$gte"===r)return t>=e;if("$lt"===r)return t<e;if("$lte"===r)return t<=e;if("$eq"===r){if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(let n=0;n<e.length;n++)if(!i(t[n],e[n],"$eq"))return!1;return!0}return t===e}return"$ne"===r?!i(t,e,"$eq"):"$exists"===r?null!=t===Boolean(e):"$fn"===r?e(t):"$re"===r?e.test(t):!!o(t)&&(o(e)?n(t[r],e):i(t[r],e,"$eq"))}return n(t,e)},t.setAnimation=function(t,e,n,r){n||(n=1e3),r||(r=100);let o=0,i=h(t,o/n);e(i,o,function u(){return o+=r,i=h(t,o/n),setTimeout((function(){e(i,o,o<n?u():null)}),r)}())},t.shuffleArray=function(t){let e=t.length;for(;e>0;){let n=Math.floor(Math.random()*e);e--,[t[e],t[n]]=[t[n],t[e]]}return t},t.sortArray=function(t,e){return e=Boolean(e),t.sort((function(t,n){return e?!a(t,n):a(t,n)}))},t.sortBy=function(t,e){return"string"==typeof e&&(e=e.split(" ").filter(Boolean)),t.sort((function(t,n){for(const r of e){const e=/^-/.test(r),o=r.replace(/^-/,""),i=a(t[o],n[o]);if(0!==i)return e?-i:i}return 0}))},t.splitFloat=function(t){return t.split(/([0-9]+\.[0-9]+)+/)},t.splitInt=function(t){return t.split(/([0-9]+)/)},t.spreadArray=function(t){function e(t,e){for(let n=t.length-1;n>=0;n--){if(e[n]<t[n].length-1)return e[n]+=1,e;e[n]=0}}function n(t,e){let n=[];for(let r=0;r<t.length;r++)n.push(t[r][e[r]]);return n}return function(){let r=[],o=function(t){if(t.length<1)return;let e=[];for(let n=0;n<t.length;n++)e.push(0);return e}(t);for(;o;)r.push(n(t,o)),o=e(t,o);return r}()},t.strToDom=function(t){t=function(t){function e(...t){return`=${y(t[1])} `}return t.replace(/\='([^'>]*?)'/g,e).replace(/\="([^">]*?)"/g,e)}($(function(t){return t.replace(/(<script(?:[\s\S]*?)>)([\s\S]*?)(<\/script>)/g,(function(...t){return`${t[1]}${y(t[2])}${t[3]}`}))}(function(t){return t.replace(/<!--([\s\S]*?)-->/g,(function(...t){return`\x3c!--\x3e${y(t[1])}</!--\x3e`}))}(function(t){return t.replace(/\r\n/g,"\n")}(t)))));let e,n,r=0,o=/<[^>]*?>/g,i=[],u=[];for(;e=o.exec(t);){let l=t.substring(r,e.index).trim();if(l.length>0&&(n={tag:null,closer:null,content:b(l),attributes:{},children:[]},i.push(n)),n=C(e[0]),n.isClosing){let t=x(i,(function(t){return!t.isClosed&&t.tag===n.tag}));if(t>-1&&(i[t].isClosed=!0,i[t].children=i.splice(t+1,i.length-t+1),["script","!--"].indexOf(i[t].tag)>-1))for(let e=0;e<i[t].children.length;e++)null===i[t].children[e].tag&&(i[t].children[e].content=m(i[t].children[e].content))}else i.push(n),u.push(n);r=o.lastIndex}let l=t.substring(r).trim();l.length>0&&(n={tag:null,closer:null,content:b(l),attributes:{},children:[]},i.push(n));for(let t of u)"!DOCTYPE"===t.tag.toUpperCase()?t.closer="":"?xml"===t.tag.toLowerCase()?t.closer="?":"!--"===t.tag?t.closer="--":t.isClosed||(t.closer=" /"),delete t.isClosed,delete t.isClosing;return{tag:null,closer:null,content:null,attributes:{},children:i}},t.toBase64=function(t,e){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(t=String(t),/[^\0-\xFF]/.test(t))throw new Error("The string to be encoded contains characters outside of the Latin1 range.");let r,o,i,u,l=t.length%3,f="",c=-1,s=t.length-l;for(;++c<s;)r=t.charCodeAt(c)<<16,o=t.charCodeAt(++c)<<8,i=t.charCodeAt(++c),u=r+o+i,f+=n.charAt(u>>18&63)+n.charAt(u>>12&63)+n.charAt(u>>6&63)+n.charAt(63&u);return 2==l?(r=t.charCodeAt(c)<<8,o=t.charCodeAt(++c),u=r+o,f+=n.charAt(u>>10)+n.charAt(u>>4&63)+n.charAt(u<<2&63)+"="):1==l&&(u=t.charCodeAt(c),f+=n.charAt(u>>2)+n.charAt(u<<4&63)+"=="),e?"data:"+e+";base64,"+f:f},t.toFullWidth=function(t){return t.replace(/[!-~]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)+65248)})).replace(/[^\S\r\n]/g,"　")},t.toHalfWidth=function(t){return t.replace(/[！-～]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)-65248)})).replace(/[^\S\r\n]/g," ")},t.updateObject=function(t,e){for(const n of Object.keys(e))for(let[r,i]of Object.entries(e[n])){r=r.split(".");let e=t,u=r.pop();for(;o(e)&&r.length>0;)e=e[r.shift()];if(o(e))if("$set"===n)e[u]!==i&&(e[u]=i);else if("$unset"===n)i&&delete e[u];else if("$push"===n)e[u].push(i);else if("$pushAll"===n)for(const t of i)e[u].push(t);else if("$pull"===n){for(let t=e[u].length;t>=0;t--)if(e[u][t]===i){e[u].splice(t,1);break}}else if("$pullAll"===n){const t=e[u];e[u]=[];for(const n of t)-1===i.indexOf(n)&&e[u].push(n)}else if("$addToSet"===n)-1===e[u].indexOf(i)&&e[u].push(i);else if("$addToSetAll"===n)for(const t of i)-1===e[u].indexOf(t)&&e[u].push(t)}return t},t.wait=function(t){return new Promise((function(e){return setTimeout(e,t)}))}}));
